"use strict";function _defineProperty(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}var $solspaceCalendar=$("#solspace-calendar"),$solspaceCalendarSpinner=null,renderEvent=function(e,a){if(e.allDay&&a.addClass("fc-event-all-day"),e.end){if(e.multiDay||e.allDay)a.addClass("fc-event-multi-day");else{a.addClass("fc-event-single-day");var n=$("<span />").addClass("fc-color-icon").css("background-color",e.backgroundColor).css("border-color",e.borderColor);$(".fc-content",a).prepend(n)}e.enabled||a.addClass("fc-event-disabled"),a.addClass("fc-color-"+e.textColor),buildEventPopup(e,a)}},today=new moment,renderDay=function(e,a){var n=a.parents(".fc-bg:first").siblings(".fc-content-skeleton").find("thead > tr > td:eq("+a.index()+")"),t=getDayViewLink(e),r=$("<a />").attr("href",t).html(n.html());n.html(r)},renderView=function(e,a){var n=a.parents("#solspace-calendar"),t=new moment(n.data("current-day"));if("agendaWeek"===e.name){var r=$(".fc-day-header.fc-widget-header",a);r.each(function(){var e=$(this).html(),a=e.split(" ");e=a[0]+" <span>"+a[1]+"</span>";var n=new moment($(this).data("date")),r=getDayViewLink(n),d=$("<a />").attr("href",r).html(e);t.format("YYYYMMDD")===n.format("YYYYMMDD")&&d.addClass("fc-title-today"),$(this).html(d)})}$(".fc-localeButton-button",$solspaceCalendar).addClass("menubtn btn"),"agendaDay"===e.name&&$("thead.fc-head",a).remove()},eventRepositioned=function(e,a,n,t){$.ajax({url:Craft.getCpUrl("calendar/events/api/modify-"+e),type:"post",dataType:"json",data:_defineProperty({eventId:a.id,siteId:a.site.id,isAllDay:a.allDay,startDate:a.start.toISOString(),endDate:a.end?a.end.toISOString():null,deltaSeconds:n.as("seconds")},Craft.csrfTokenName,Craft.csrfTokenValue),success:function(e){e.error?t():a.repeats&&$calendar.fullCalendar("refetchEvents")},error:function(){t()}})},eventDateChange=function(e,a,n){eventRepositioned("date",e,a,n)},eventDurationChange=function(e,a,n){eventRepositioned("duration",e,a,n)},eventClick=function(e){window.location.href=Craft.getCpUrl("calendar/events/"+e.id+"/"+e.site.handle)},getDayViewLink=function(e){if(e.isValid()){var a=e.format("YYYY"),n=e.format("MM"),t=e.format("DD");return Craft.getCpUrl("calendar/view/day/"+a+"/"+n+"/"+t)}return""},getEvents=function(e,a,n,t){getSpinner().fadeIn("fast");var r=$("ul.calendar-list"),d="*";r.length&&(d=$("input:checked",r).map(function(){return $(this).val()}).get().join());var l=$calendar.data(),i=l.currentSiteId;$.ajax({url:Craft.getCpUrl("calendar/month"),data:_defineProperty({rangeStart:e.toISOString(),rangeEnd:a.toISOString(),calendars:d,siteId:i},Craft.csrfTokenName,Craft.csrfTokenValue),type:"post",dataType:"json",success:function(e){for(var a=0;a<e.length;a++){var n=e[a];n.allDay&&(e[a].end=moment(n.end).add(2,"s").utc().format())}t(e),getSpinner().fadeOut("fast")}})},closeAllQTips=function(){qTipsEnabled=!1,$("div.qtip:visible").qtip("hide")},enableQTips=function(){qTipsEnabled=!0},getSpinner=function(){return $solspaceCalendarSpinner||($solspaceCalendar.find(".fc-right").prepend('<div id="solspace-calendar-spinner" class="spinner" style="display: none;"></div>'),$solspaceCalendarSpinner=$("#solspace-calendar-spinner")),$solspaceCalendarSpinner};